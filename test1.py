# ALL_LIST = [
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': '香港九龍高輝道17號油塘工業城B2座9樓B10-B13室 ',
#   'coordinates': [22.294942, 114.2351026],
#   'district': '觀塘區'},
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': '北角英皇道663號千禧廣場9字樓08室 ',
#   'coordinates': [22.2916983, 114.2081683],
#   'district': '東區'},
#  {'address': '香港觀塘 開源道49號 創貿廣場 23樓2308室',
#   'coordinates': [22.3102581, 114.2236787],
#   'district': '觀塘區'},
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': '柴灣利眾街20號柴灣中心工業大廈1/F ',
#   'coordinates': [22.266277, 114.236681],
#   'district': '東區'},
#  {'address': '深水埗九江街168號地下',
#   'coordinates': [22.3346336, 114.1622091],
#   'district': '深水埗區'},
#  {'address': '九龍官塘成業街16號怡生工業中心9樓G座',
#   'coordinates': [22.309575, 114.225821],
#   'district': '觀塘區'},
#  {'address': '觀塘榮業街2號振萬廣場 4樓403-405室 ',
#   'coordinates': [22.3073397, 114.2230667],
#   'district': '觀塘區'},
#  {'address': 'Flat V 9/F, Block 3 Kwun Tong Industrial Centre, 448-458 Kwun '
#              'Tong Road, Kwun Tong, Hong Kong',
#   'coordinates': [22.3110425, 114.2279277],
#   'district': '觀塘區'},
#  {'address': '尖沙咀廣東道30號新港中心1座510室',
#   'coordinates': [22.297485, 114.169408],
#   'district': '油尖旺區'},
#  {'address': '九龍太子道97-101號地下',
#   'coordinates': [22.323294, 114.165751],
#   'district': '油尖旺區'},
#  {'address': '觀塘海濱道177號海裕工業中心3字 樓',
#   'coordinates': [22.3098695, 114.22021],
#   'district': '觀塘區'},
#  {'address': '香港荃灣德士古道220-248號全灣工業中心10樓1008室',
#   'coordinates': [22.36504, 114.115642],
#   'district': '南區'},
#  {'address': '新界葵涌貨櫃碼頭51-63號葵順工業中心2樓E室',
#   'coordinates': [22.3532957, 114.1241366],
#   'district': '灣仔區'},
#  {'address': '九龍深水步石硤尾街1號地下M3鋪',
#   'coordinates': [22.3276924, 114.1632293],
#   'district': '深水埗區'},
#  {'address': '觀塘榮業街2號振萬廣場 4樓403-405室 ',
#   'coordinates': [22.3073397, 114.2230667],
#   'district': '葵青區'},
#  {'address': '九龍灣常悅道9號企業廣場1期2座905室',
#   'coordinates': [22.3220434, 114.207954],
#   'district': '觀塘區'},
#  {'address': '香港仔大道234號富嘉工業大廈16字樓6-7室',
#   'coordinates': [22.248878, 114.152697],
#   'district': '南區'},
#  {'address': '香港九龍觀塘鴻圖道37-39號鴻泰工業大廈411室',
#   'coordinates': [22.3123292, 114.2209155],
#   'district': '觀塘區'},
#  {'address': '九龍新蒲崗八達街1號八達工業大廈14樓',
#   'coordinates': [22.3369881, 114.1985079],
#   'district': '九龍城區'},
#  {'address': '長沙灣青山道 538號, 半島大厦, 10樓 1010 室',
#   'coordinates': [22.339475, 114.150717],
#   'district': '深水埗區'},
#  {'address': '九龍深水步界限街15號A3地下',
#   'coordinates': [22.3265175, 114.1644415],
#   'district': '深水埗區'},
#  {'address': '香港黃竹坑業興街11號南匯廣場A座5字樓',
#   'coordinates': [22.249053, 114.164976],
#   'district': '中西區'},
#  {'address': '九龍深水步大南街228號地下',
#   'coordinates': [22.3277939, 114.1626571],
#   'district': '深水埗區'},
#  {'address': '九龍油麻地碧街16號地下',
#   'coordinates': [22.31327, 114.167755],
#   'district': '油尖旺區'},
#  {'address': '香港葵芳新都會廣場第二座28樓05 - 06室',
#   'coordinates': [22.357444, 114.1263314],
#   'district': '葵青區'},
#  {'address': '西環域多利道62號耀基工廠大廈18字樓',
#   'coordinates': [22.2817123, 114.122058],
#   'district': '中西區'},
#  {'address': '大埔工業村大富街18號 ',
#   'coordinates': [22.4585505, 114.1845751],
#   'district': '大埔區'},
#  {'address': '旺角廣東道911號地下',
#   'coordinates': [22.315298, 114.1678265],
#   'district': '油尖旺區'},
#  {'address': '新界葵涌大連排道21-33號宏達工業中心5樓19室  ',
#   'coordinates': [22.364739, 114.134371],
#   'district': '葵青區'},
#  {'address': '葵涌大連排道152-160號金龍工業大廈一座5樓J室',
#   'coordinates': [22.3582077, 114.1315318],
#   'district': '葵青區'},
#  {'address': '香港荃灣 青山道264-298 南豐中心1905 室',
#   'coordinates': [22.3738014, 114.1163447],
#   'district': '荃灣區'},
#  {'address': '香港柴灣吉勝街8號吉勝大廈6樓B座',
#   'coordinates': [22.2641019, 114.2362403],
#   'district': '東區'},
#  {'address': '九龍九龍灣宏照道39號企業廣場第3期901室',
#   'coordinates': [22.3198596, 114.2097232],
#   'district': '觀塘區'},
#  {'address': '新界沙田火炭坳背灣街27-31號協興工業中心',
#   'coordinates': [22.3968516, 114.195675],
#   'district': '沙田區'},
#  {'address': '長沙灣道912號時信中心1樓6室',
#   'coordinates': [22.3370178, 114.1462345],
#   'district': '深水埗區'},
#  {'address': '荃灣美環街1-6號時貿中心26字樓9號室',
#   'coordinates': [22.3751918, 114.1144402],
#   'district': '荃灣區'},
#  {'address': '九龍深水埗汝州街 95 號地下',
#   'coordinates': [22.327137, 114.164795],
#   'district': '深水埗區'},
#  {'address': '九龍深水埗汝洲街 91 號地下',
#   'coordinates': [22.3271056, 114.1648595],
#   'district': '深水埗區'},
#  {'address': '荃灣沙咀道57號荃運工業大廈 2期 25樓 E 座',
#   'coordinates': [22.373696, 114.110203],
#   'district': '荃灣區'},
#  {'address': '九龍長沙灣永康街29-33號兆威工業大廈2字樓',
#   'coordinates': [22.338697, 114.146572],
#   'district': '深水埗區'},
#  {'address': '新界葵涌打磚坪街冠和工廠大廈 2 樓 F5 室',
#   'coordinates': [22.368185, 114.13668],
#   'district': '葵青區'},
#  {'address': '九龍觀塘道460-470號官塘工業中心第二期13樓T室',
#   'coordinates': [22.31098, 114.227845],
#   'district': '觀塘區'},
#  {'address': '香港九龍新蒲崗大有街3號萬迪廣場18樓H&J室',
#   'coordinates': [22.3383102, 114.1991409],
#   'district': '觀塘區'},
#  {'address': '九龍旺角新填地街304號地下',
#   'coordinates': [22.314733, 114.168697],
#   'district': '油尖旺區'},
#  {'address': '九龍深水埗汝洲街 127 號地下',
#   'coordinates': [22.327744, 114.1640346],
#   'district': '深水埗區'},
#  {'address': '九龍觀塘開源道72號溢財中心C座地下',
#   'coordinates': [22.3115975, 114.2265115],
#   'district': '觀塘區'},
#  {'address': '柴灣吉勝街45號勝景工業大廈4/FC座',
#   'coordinates': [22.265669, 114.2350097],
#   'district': '中西區'},
#  {'address': 'Room15,1/F,Shing Yip Industrial Building,19-21 Shing Yip '
#              'Street,Kwun Tong',
#   'coordinates': [22.3101147, 114.2270687],
#   'district': '觀塘區'},
#  {'address': '香港九龍觀塘巧明街100號安盛金融大樓28樓2801室',
#   'coordinates': [22.3122493, 114.2232143],
#   'district': '觀塘區'},
#  {'address': '香港北角屈臣道海景大廈B座401號及409號',
#   'coordinates': [22.287045, 114.191318],
#   'district': '中西區'},
#  {'address': '香港北角屈臣道海景大廈B座401號及409號',
#   'coordinates': [22.287045, 114.191318],
#   'district': '中西區'},
#  {'address': '香港九龍深水埗基隆街 180 A 號 地下',
#   'coordinates': [22.3280827, 114.1631414],
#   'district': '深水埗區'},
#  {'address': '九龍官塘鴻圖路9號建業中心8樓806室',
#   'coordinates': [22.3140869, 114.2187561],
#   'district': '觀塘區'},
#  {'address': '九龍觀塘道460-470號官塘工業中心第二期13樓T室',
#   'coordinates': [22.31098, 114.227845],
#   'district': '觀塘區'},
#  {'address': '九龍長沙灣道883號億利工業中心7樓711室',
#   'coordinates': [22.3367537, 114.1476756],
#   'district': '深水埗區'},
#  {'address': '柴灣利眾街20號柴灣中心工業大廈1/F ',
#   'coordinates': [22.266277, 114.236681],
#   'district': '東區'},
#  {'address': '深水步楓樹街17號地下',
#   'coordinates': [22.3269601, 114.1649524],
#   'district': '深水埗區'},
#  {'address': '新界葵涌嘉慶路5-9號冠華鏡廠第三工業大廈',
#   'coordinates': [22.359531, 114.1319053],
#   'district': '葵青區'},
#  {'address': '九龍深水步基隆街141號',
#   'coordinates': [22.3268142, 114.1643552],
#   'district': '深水埗區'},
#  {'address': '香港北角屈臣道海景大廈B座401號及409號',
#   'coordinates': [22.287045, 114.191318],
#   'district': '中西區'},
#  {'address': '新界元朗大旗嶺737號',
#   'coordinates': [22.4389753, 114.0296526],
#   'district': '元朗區'},
#  {'address': '葵涌葵豐街 18-26 號 永康工業大廈 14 字樓 C座',
#   'coordinates': [22.3555633, 114.1247057],
#   'district': '葵青區'},
#  {'address': '九龍灣常悅道3號企業廣2期25樓2-5室',
#   'coordinates': [22.3217472, 114.2072389],
#   'district': '觀塘區'},
#  {'address': '九龍深水步石硤尾街1L 號 地下',
#   'coordinates': [22.327547, 114.163008],
#   'district': '深水埗區'},
#  {'address': '屯門建榮街114號恆威工業中心A座711',
#   'coordinates': [22.39545, 113.970151],
#   'district': '屯門區'},
#  {'address': '官塘鴻圖道57號南洋廣場1803A室',
#   'coordinates': [22.31042, 114.222775],
#   'district': '觀塘區'},
#  {'address': '沙田安平街6號新貿中心B座15樓01室',
#   'coordinates': [22.390624, 114.207661],
#   'district': '沙田區'},
#  {'address': '觀塘榮業街2號振萬廣場 4樓403-405室 ',
#   'coordinates': [22.3073397, 114.2230667],
#   'district': '觀塘區'},
#  {'address': '新界荃灣沙咀道66A豪力中心2105室',
#   'coordinates': [22.3730339, 114.1097471],
#   'district': '荃灣區'},
#  {'address': '深水埗黃竹街 2 號 L 舖地下',
#   'coordinates': [22.326557, 114.163689],
#   'district': '深水埗區'},
#  {'address': '九龍旺角新填地街411號地下',
#   'coordinates': [22.3183303, 114.1676609],
#   'district': '油尖旺區'},
#  {'address': '新界荃灣海盛路3號TML廣場22樓C5室  ',
#   'coordinates': [22.3736984, 114.1062155],
#   'district': '荃灣區'},
#  {'address': '香港皇后大道中208號勝基中心14樓',
#   'coordinates': [22.2846531, 114.1520985],
#   'district': '中西區'},
#  {'address': '九龍深水埗基隆街 157 號地下 ',
#   'coordinates': [22.327168, 114.16392],
#   'district': '深水埗區'},
#  {'address': '九龍深水步汝洲街163號地下',
#   'coordinates': [22.3283319, 114.1633036],
#   'district': '深水埗區'},
#  {'address': '5/F, Kut Shing Building,Kut Shing Street,Chai Wan,Hong Kong',
#   'coordinates': [22.265629, 114.234956],
#   'district': '東區'},
#  {'address': '香港荃灣白田壩街5-21號, 嘉力工業中心 A座4樓15室',
#   'coordinates': [22.3749201, 114.1088895],
#   'district': '荃灣區'},
#  {'address': '香港北角屈臣道海景大廈B座401號及409號',
#   'coordinates': [22.287045, 114.191318],
#   'district': '中西區'},
#  {'address': '九龍新填地街329B地下',
#   'coordinates': [22.3159729, 114.1681339],
#   'district': '油尖旺區'},
#  {'address': '九龍青山道576-586號製衣中心11樓2室',
#   'coordinates': [22.339284, 114.149999],
#   'district': '深水埗區'},
#  {'address': '柴灣吉勝街45號吉勝工業大廈6/FC座',
#   'coordinates': [22.265669, 114.2350097],
#   'district': '中西區'},
#  {'address': '香港黃竹坑業興街11號南匯廣場A座5字樓',
#   'coordinates': [22.249053, 114.164976],
#   'district': '中西區'},
#  {'address': '香港九龍觀塘巧明街100號安盛金融大樓28樓2801室',
#   'coordinates': [22.3122493, 114.2232143],
#   'district': '觀塘區'},
#  {'address': '九龍旺角上海街697-699號地下',
#   'coordinates': [22.322906, 114.1672554],
#   'district': '油尖旺區'},
#  {'address': 'Flat /RM 901 9/F , SUI WAI iND CENTRE 29-33 WING HONG  ',
#   'coordinates': [22.396428, 114.109497],
#   'district': '荃灣區'},
#  {'address': '上環德輔道中232號嘉華銀行中心1801室',
#   'coordinates': [22.28627, 114.152767],
#   'district': '中西區'},
#  {'address': '九龍長沙灣長裕街2號, 嘉圖工廠大廈3樓D室',
#   'coordinates': [22.336377, 114.150159],
#   'district': '深水埗區'},
#  {'address': '沙田火炭坳背灣街27-31號協興工業中心4字樓D座',
#   'coordinates': [22.3970942, 114.1956308],
#   'district': '沙田區'},
#  {'address': '九龍旺角新填地街473號地下',
#   'coordinates': [22.320139, 114.1673621],
#   'district': '油尖旺區'},
#  {'address': '香港九龍深水埗汝州街138號2B地下',
#   'coordinates': [22.328188, 114.163959],
#   'district': '深水埗區'},
#  {'address': '九龍觀塘觀塘道418號創紀之城五期1501至1508室 ',
#   'coordinates': [22.312401, 114.225222],
#   'district': '觀塘區'},
#  {'address': '九龍灣臨樂街19號南豐商業中心7樓702室 ',
#   'coordinates': [22.322801, 114.207742],
#   'district': '觀塘區'},
#  {'address': '香港九龍新蒲崗六合街23號萬昌中心25樓5-6室',
#   'coordinates': [22.3370874, 114.2000869],
#   'district': '九龍城區'},
#  {'address': '九龍深水埗汝州街 137 號地下',
#   'coordinates': [22.327849, 114.163911],
#   'district': '深水埗區'},
#  {'address': '新界大埔工業村大富街18號',
#   'coordinates': [22.4585505, 114.1845751],
#   'district': '大埔區'},
#  {'address': '觀塘道410號觀點中心22樓2202室',
#   'coordinates': [22.3128723, 114.2242359],
#   'district': '觀塘區'},
#  {'address': 'Unit E, 7/F, Mai Tak Industrial Building, 221 Wai Yip Street, '
#              'Kwun Tong, Hong Kong',
#   'coordinates': [22.308479, 114.223096],
#   'district': '觀塘區'},
#  {'address': '深水步基隆街 194 號地下',
#   'coordinates': [22.3283018, 114.1629849],
#   'district': '深水埗區'},
#  {'address': '驊浚貨運有限公司香港九龍高輝道17號, 油塘工業城B2座9樓B10-B13室 ',
#   'coordinates': [22.294942, 114.2351026],
#   'district': '觀塘區'},
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': '香港葵芳新都會廣場第二座2805-2806室',
#   'coordinates': [22.3573576, 114.1268584],
#   'district': '葵青區'},
#  {'address': '香港九龍青山道五百七十六號製衣中心二字樓',
#   'coordinates': [22.339284, 114.149999],
#   'district': '深水埗區'},
#  {'address': '香港柴灣新業街11號森龍工業大廈2字樓B座',
#   'coordinates': [22.267821, 114.2460979],
#   'district': '東區'},
#  {'address': '觀塘開源道48號威利廣場17樓1701室  ',
#   'coordinates': [22.3090146, 114.2234507],
#   'district': '觀塘區'},
#  {'address': '九龍長沙灣長裕街12號經達廣場30樓',
#   'coordinates': [22.3374742, 114.1506702],
#   'district': '深水埗區'},
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': ' 尖沙咀麼地道77號華懋廣場12樓1208室  ',
#   'coordinates': [22.3000169, 114.1792154],
#   'district': '油尖旺區'},
#  {'address': '16/F-17/F, Tower B, Regent Centre,63 Wo Yi Hop Road, Kwai Chung, '
#              'New Territories, HK',
#   'coordinates': [22.3672642, 114.1378971],
#   'district': '葵青區'},
#  {'address': '越華實業公司香港荃灣白田壩街5-21號嘉力工業中心 A座4樓15室',
#   'coordinates': [22.3749, 114.10882],
#   'district': '荃灣區'},
#  {'address': '葵涌葵喜街 13-29 號永恆工業大廈4樓12號室',
#   'coordinates': [22.3568072, 114.1237302],
#   'district': '葵青區'},
#  {'address': '九龍深水埗海壇街206號地下',
#   'coordinates': [22.327908, 114.15961],
#   'district': '深水埗區'},
#  {'address': '九龍觀塘道460-470號官塘工業中心第二期13樓T室',
#   'coordinates': [22.31098, 114.227845],
#   'district': '觀塘區'},
#  {'address': '葵涌華星街1-7號美華工業大廈12樓A室',
#   'coordinates': [22.3633442, 114.1339955],
#   'district': '葵青區'},
#  {'address': "Room 1701 Kwai Hung Holdings Centre, 89 King's Road, North "
#              'Point, HongKong',
#   'coordinates': [22.2865344, 114.1926794],
#   'district': '東區'},
#  {'address': '3F Perfect Industrial Building, 31 Tai Yau Street,Sanpokong, '
#              'KowloonHong Kong',
#   'coordinates': [22.336669, 114.198096],
#   'district': '九龍城區'},
#  {'address': '香港仔香港仔大道234號富嘉工業大廈20樓12室',
#   'coordinates': [22.248849, 114.152779],
#   'district': '中西區'},
#  {'address': 'ROOM G02, 15/F,LEGEND TOWER, NO. 7 SHING YIP STREET,KWUN TONG, '
#              'KOWLOON, ',
#   'coordinates': [22.310881, 114.226296],
#   'district': '觀塘區'},
#  {'address': '新界大埔工業村大富街18號',
#   'coordinates': [22.4585505, 114.1845751],
#   'district': '大埔區'},
#  {'address': '九龍深水埗大南街 72 號地下',
#   'coordinates': [22.3251134, 114.166205],
#   'district': '深水埗區'},
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': 'Flat D, 28/F, Vigor Industrial Building, Block 249-53 Ta Chuen '
#              'Ping StreetKwai Chung, N.T.',
#   'coordinates': [22.367954, 114.135603],
#   'district': '葵青區'},
#  {'address': '大埔工業村大富街18號 ',
#   'coordinates': [22.4585505, 114.1845751],
#   'district': '大埔區'},
#  {'address': '大埔工業村大富街18號 ',
#   'coordinates': [22.4585505, 114.1845751],
#   'district': '大埔區'},
#  # {'address': '香港九龍旺角通菜街1A-1L威逢商業大廈10樓1003室',
#  #  'coordinates': [22.3162709, 114.1710209],
#  #  'district': '油尖旺區'},
#  {'address': '觀塘鴻圖道55號幸運工業大廈3樓G室 ',
#   'coordinates': [22.3107976, 114.2224713],
#   'district': '觀塘區'},
#  {'address': '覲塘開源道62號駱駝漆大廈1期7樓B11室',
#   'coordinates': [22.3105289, 114.2249511],
#   'district': '觀塘區'},
#  {'address': '青衣青衣路39號嘉民領達中心18樓',
#   'coordinates': [22.3319536, 114.1084198],
#   'district': '葵青區'},
#  {'address': '香港柴灣新業街6號安力工業中心7樓11室',
#   'coordinates': [22.2662973, 114.2473156],
#   'district': '東區'},
#  {'address': '香港北角屈臣道海景大廈B座401號及409號',
#   'coordinates': [22.287045, 114.191318],
#   'district': '中西區'},
#  {'address': '北角英皇道663號千禧廣場9字樓01-03室 ',
#   'coordinates': [22.2916983, 114.2081683],
#   'district': '東區'},
#  {'address': '香港銅鑼灣皇冠假日酒店香港銅鑼灣禮頓道8號 ',
#   'coordinates': [22.2770558, 114.1826193],
#   'district': '灣仔區'},
#  {'address': '新界葵涌葵發路2至12號大德工業大廈3字樓A ',
#   'coordinates': [22.365696, 114.134002],
#   'district': '葵青區'},
#  {'address': '香港銅鑼灣禮頓道111利園六期20 Floor',
#   'coordinates': [22.2776856, 114.1857595],
#   'district': '中西區'},
#  {'address': '荔枝角道長裕街12號 經達廣場26樓05室',
#   'coordinates': [22.3374742, 114.1506702],
#   'district': '九龍城區'},
#  {'address': '香港北角英皇道625号26楼 ',
#   'coordinates': [22.2923038, 114.2062636],
#   'district': '東區'},
#  {'address': '香港黃竹坑業興街11號南匯廣場A座5字樓',
#   'coordinates': [22.249053, 114.164976],
#   'district': '中西區'},
#  {'address': '大埔工業村大富街18號 ',
#   'coordinates': [22.4585505, 114.1845751],
#   'district': '大埔區'},
#  {'address': ' 柴灣 嘉業街18號 明報工業中心B座18樓',
#   'coordinates': [22.268442, 114.2449168],
#   'district': '中西區'},
#  {'address': '觀塘榮業街2號振萬廣場 4樓403-405室 ',
#   'coordinates': [22.3073397, 114.2230667],
#   'district': '觀塘區'},
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': '觀塘工業中心二期五樓C室',
#   'coordinates': [22.31098, 114.227845],
#   'district': '觀塘區'},
#  {'address': '志源洋行九龍長沙灣長沙灣道883號億利工業中心7樓711室',
#   'coordinates': [22.3367537, 114.1476756],
#   'district': '深水埗區'},
#  {'address': '深水步汝洲街144地下',
#   'coordinates': [22.328423, 114.163687],
#   'district': '深水埗區'},
#  {'address': '香港 北角電氣道169號康宏匯20樓 ',
#   'coordinates': [22.2877503, 114.1915011],
#   'district': '東區'},
#  {'address': 'G/F, Kai Fung Building,4-6 Jervois Street, Sheung Wan,Hong Kong',
#   'coordinates': [22.2851026, 114.1526474],
#   'district': '中西區'},
#  {'address': 'No. 61-63 King Yip Street,3/F, Liven House, Kwun Tong, ',
#   'coordinates': [22.309124, 114.2264174],
#   'district': '觀塘區'},
#  {'address': 'No. 61-63 King Yip Street,3/F, Liven House, Kwun Tong, ',
#   'coordinates': [22.309124, 114.2264174],
#   'district': '觀塘區'},
#  {'address': '九龍深水埗基隆街152 號地下',
#   'coordinates': [22.327656, 114.163804],
#   'district': '深水埗區'},
#  {'address': '九龍深水步石硤尾街11至17號地下',
#   'coordinates': [22.328459, 114.163871],
#   'district': '深水埗區'},
#  {'address': '觀塘開源道48號威利廣場17樓1701室  ',
#   'coordinates': [22.3090146, 114.2234507],
#   'district': '觀塘區'},
#  {'address': '葵涌 葵喜街26-32號金發工業大廈二期3樓F室',
#   'coordinates': [22.3578435, 114.1221451],
#   'district': '葵青區'},
#  {'address': '九龍灣宏照道33號國際交易中心28樓2808室',
#   'coordinates': [22.321063, 114.209395],
#   'district': '觀塘區'},
#  {'address': '九龍深水埗 汝洲街 164 號地下',
#   'coordinates': [22.328784, 114.163221],
#   'district': '深水埗區'},
#  {'address': ' 柴灣 嘉業街18號 明報工業中心B座18樓18 KA YIP STREET, CHAI WAN, HONG KONG ',
#   'coordinates': [22.268442, 114.2449168],
#   'district': '中西區'},
#  {'address': '香港北角屈臣道海景大廈B座401號及409號',
#   'coordinates': [22.287045, 114.191318],
#   'district': '中西區'},
#  {'address': 'Room15,1/F,Shing Yip Industrial Building,19-21 Shing Yip Str',
#   'coordinates': [22.3101147, 114.2270687],
#   'district': '觀塘區'},
#  {'address': '九龍深水步汝洲街126號地下',
#   'coordinates': [22.32799, 114.164201],
#   'district': '深水埗區'},
#  {'address': '觀塘開源道54號豐利中心102-103',
#   'coordinates': [22.30958, 114.224095],
#   'district': '觀塘區'},
#  {'address': '九龍灣啟興道1-3號九龍貨倉3樓D座',
#   'coordinates': [22.3155128, 114.2127653],
#   'district': '九龍城區'},
#  {'address': 'SUITES 1010-11, 10/F. EXCHANGE TOWER, 33 WANG CHIU ROAD, KOWLOON '
#              'BAY',
#   'coordinates': [22.3210973, 114.2094216],
#   'district': '九龍城區'},
#  {'address': '35/F., Standard Chartered Tower, Millennium City 1, 388 Kwun '
#              'Tong Rd., Kwun Tong, Kowloon ',
#   'coordinates': [22.31394, 114.2212701],
#   'district': '觀塘區'},
#  {'address': '葵涌華星街1-7號美華工業大廈12樓A室',
#   'coordinates': [22.3633442, 114.1339955],
#   'district': '葵青區'},
#  {'address': '黃竹坑業興街11號南匯廣場A座27樓',
#   'coordinates': [22.2492849, 114.1650392],
#   'district': '南區'},
#  {'address': '荃灣柴灣角街84-92號順豐工業中心24樓E室',
#   'coordinates': [22.3724144, 114.1088621],
#   'district': '荃灣區'},
#  {'address': '葵涌山頂道313號天際中心28樓2808室',
#   'coordinates': [22.3605461, 114.1352585],
#   'district': '葵青區'},
#  {'address': '長沙灣長裕街10號億京廣場16樓A室',
#   'coordinates': [22.3366021, 114.1506702],
#   'district': '深水埗區'},
#  {'address': '葵芳興芳路223號新都會廣場2座7樓 721-722室',
#   'coordinates': [22.3572368, 114.1271323],
#   'district': '葵青區'},
#  {'address': '荃灣沙咀道29-35號科技中心12樓1208-1210室',
#   'coordinates': [22.3742236, 114.108959],
#   'district': '荃灣區'},
#  {'address': '葵涌永基路55號嘉里貨運中心16樓1605室',
#   'coordinates': [22.363254, 114.120828],
#   'district': '葵青區'},
#  {'address': '葵涌貨櫃碼頭路88號永得利廣場1座12樓1208室 ',
#   'coordinates': [22.352507, 114.124324],
#   'district': '葵青區'},
#  {'address': '九龍灣臨澤街8號傲騰廣場1302室',
#   'coordinates': [22.3155222, 114.211962],
#   'district': '觀塘區'},
#  {'address': '葵涌貨櫃碼頭路88號永德利廣場1座19樓1905-1910室',
#   'coordinates': [22.3525005, 114.1243391],
#   'district': '葵青區'},
#  {'address': '觀塘偉業街223-231號, 宏利金融中心, B座, 18樓',
#   'coordinates': [22.3073879, 114.2240354],
#   'district': '觀塘區'},
#  {'address': '觀塘敬業街49號建生商業中心16樓1601-5室',
#   'coordinates': [22.308319, 114.225608],
#   'district': '觀塘區'},
#  {'address': '葵涌貨櫃碼頭路51-63號葵順工業中心12樓C1',
#   'coordinates': [22.3532957, 114.1241366],
#   'district': '葵青區'},
#  {'address': '荔枝角道838號勵豐中心17樓1704-6室',
#   'coordinates': [22.3356174, 114.1475118],
#   'district': '深水埗區'},
#  {'address': '葵涌現代貨箱碼頭公司7樓',
#   'coordinates': [22.35047, 114.122512],
#   'district': '葵青區'},
#  {'address': '葵芳興芳路223號新都會廣場1座46樓4601室',
#   'coordinates': [22.3579091, 114.1265271],
#   'district': '葵青區'},
#  {'address': '葵涌葵榮路30-34號EDGE2樓  ',
#   'coordinates': [22.3669194, 114.1345529],
#   'district': '葵青區'},
#  {'address': '葵涌葵榮路30-34號EDGE4樓',
#   'coordinates': [22.3669194, 114.1345529],
#   'district': '葵青區'},
#  {'address': '葵涌葵榮路30-34號EDGE2樓  ',
#   'coordinates': [22.3669194, 114.1345529],
#   'district': '葵青區'},
#  {'address': '葵涌貨櫃碼頭路88號永得利廣場2座23樓 ',
#   'coordinates': [22.352507, 114.124324],
#   'district': '葵青區'},
#  {'address': '九龍新蒲崗大有街35號義發工業大廈8樓A室',
#   'coordinates': [22.3357911, 114.1972669],
#   'district': '黃大仙區'},
#  {'address': '石塘咀德輔道西410號太平洋廣場10樓',
#   'coordinates': [22.286584, 114.135646],
#   'district': '中西區'},
#  {'address': '葵涌葵豐街1-15號盈業大廈B座5樓',
#   'coordinates': [22.354959, 114.124607],
#   'district': '葵青區'},
#  {'address': '九龍灣宏照道39號企業廣場三期36-37樓',
#   'coordinates': [22.3198596, 114.2097232],
#   'district': '觀塘區'},
#  {'address': '觀塘九龍灣偉業街223-231號宏利金融中心B座808室',
#   'coordinates': [22.307388, 114.224035],
#   'district': '觀塘區'},
#  {'address': '觀塘鴻圖道78號20樓B室',
#   'coordinates': [22.308311, 114.2238644],
#   'district': '觀塘區'},
#  {'address': '葵涌貨櫃碼頭路88號永德利廣場2座22樓1-3、11-12室',
#   'coordinates': [22.352478, 114.124306],
#   'district': '葵青區'},
#  {'address': '觀塘偉業街221號美德工業大廈3樓F室',
#   'coordinates': [22.3084284, 114.2231214],
#   'district': '觀塘區'},
#  {'address': '長沙灣道681號貿易廣場11樓1110室',
#   'coordinates': [22.33682, 114.153678],
#   'district': '深水埗區'},
#  {'address': '觀塘九龍灣偉業街223號-231號宏利金融中心B座7樓701A & 708B  ',
#   'coordinates': [22.3073879, 114.2240354],
#   'district': '觀塘區'},
#  {'address': '觀塘創業街36號華基中心19樓1909室',
#   'coordinates': [22.3143441, 114.2191973],
#   'district': '觀塘區'},
#  {'address': '九龍灣啟祥道26號同力工業中心A座2樓',
#   'coordinates': [22.325242, 114.210259],
#   'district': '觀塘區'},
#  {'address': '九龍灣宏照道15號11樓',
#   'coordinates': [22.3242943, 114.2090501],
#   'district': '觀塘區'},
#  {'address': '葵涌貨櫃碼頭路88號永德利廣場2座11樓1103-05室',
#   'coordinates': [22.352507, 114.124324],
#   'district': '葵青區'},
#  {'address': '荃灣楊屋道8號如心廣場2座15樓1501室',
#   'coordinates': [22.368748, 114.11299],
#   'district': '荃灣區'},
#  {'address': '荃灣沙咀道6號嘉達環球中心23樓',
#   'coordinates': [22.3750613, 114.1072403],
#   'district': '荃灣區'},
#  {'address': '九龍灣宏照道15號11樓',
#   'coordinates': [22.3242943, 114.2090501],
#   'district': '觀塘區'},
#  {'address': '長沙灣長裕街8號億京廣場19樓  ',
#   'coordinates': [22.336585, 114.150659],
#   'district': '深水埗區'},
#  {'address': '新蒲崗大有街23號寶城工業大廈9樓',
#   'coordinates': [22.3379648, 114.1988098],
#   'district': '黃大仙區'},
#  {'address': '荃灣楊屋道8號如心廣場2座2703-2704室',
#   'coordinates': [22.368748, 114.11299],
#   'district': '荃灣區'},
#  {'address': '九龍灣宏泰道23號曼克頓大廈35樓 3501室 ',
#   'coordinates': [22.3200265, 114.2099297],
#   'district': '觀塘區'},
#  {'address': '荃灣角沙咀道57號荃運工業中心（2期）23樓L室',
#   'coordinates': [22.373819, 114.109953],
#   'district': '荃灣區'},
#  {'address': '灣仔銅鑼灣駱克道93-107號利臨大廈5樓  ',
#   'coordinates': [22.2782594, 114.1721514],
#   'district': '灣仔區'},
#  {'address': '觀塘九龍灣偉業街182號觀塘碼頭廣場12樓1201室',
#   'coordinates': [22.3090118, 114.2215809],
#   'district': '觀塘區'},
#  {'address': '葵涌和宜合道63號麗晶中心A座21樓2101-2103室',
#   'coordinates': [22.3672642, 114.1378971],
#   'district': '葵青區'},
#  {'address': '九龍灣啟祥道9號信和工商中心1樓18室',
#   'coordinates': [22.3255787, 114.2053348],
#   'district': '觀塘區'},
#  {'address': '觀塘海濱道181號ONE HARBOUR SQUARE12樓',
#   'coordinates': [22.3093055, 114.220451],
#   'district': '觀塘區'},
#  {'address': '觀塘巧明街112號友聯大廈10樓',
#   'coordinates': [22.311332, 114.22405],
#   'district': '觀塘區'},
#  {'address': '土瓜灣旭日街21號聯合報大廈1樓',
#   'coordinates': [22.3167902, 114.1922747],
#   'district': '九龍城區'},
#  {'address': '葵涌葵昌路18-24號美順工業大廈C座15樓3室',
#   'coordinates': [22.3652057, 114.1332523],
#   'district': '葵青區'},
#  {'address': '葵涌3號貨櫃碼頭13004室',
#   'coordinates': [22.3430143, 114.1269711],
#   'district': '葵青區'},
#  {'address': '彌敦道430-436號彌敦商業大廈15樓A&D室',
#   'coordinates': [22.3096507, 114.171594],
#   'district': '油尖旺區'},
#  {'address': '彌敦道430-436號彌敦商業大廈15樓A&D室',
#   'coordinates': [22.3096507, 114.171594],
#   'district': '油尖旺區'},
#  {'address': '九龍灣臨樂街19號南豐商業中心16樓1618室 ',
#   'coordinates': [22.3229129, 114.2077127],
#   'district': '九龍城區'},
#  {'address': '荔枝角長順街20號時豐中心1101 & 1103室',
#   'coordinates': [22.3363742, 114.1465829],
#   'district': '葵青區'},
#  {'address': '灣仔灣仔道185號康樂商業大廈7樓702.室',
#   'coordinates': [22.2773634, 114.1779801],
#   'district': '灣仔區'},
#  {'address': '銅鑼灣威菲路道18號萬國寶通中心30樓3003室',
#   'coordinates': [22.286125, 114.190211],
#   'district': '灣仔區'},
#  {'address': '青衣航運路38號招商局物流中心12樓A室',
#   'coordinates': [22.3329355, 114.1114279],
#   'district': '葵青區'},
#  {'address': '葵涌葵榮路30-34號EDGE5樓501室',
#   'coordinates': [22.3669194, 114.1345529],
#   'district': '葵青區'},
#  {'address': '紅磡馬頭圍道37號 紅磡商業中心B座1014室',
#   'coordinates': [22.3103458, 114.1879838],
#   'district': '九龍城區'},
#  {'address': '上環干諾道中130-136號誠信大廈22樓C&D室',
#   'coordinates': [22.2870108, 114.1519348],
#   'district': '中西區'},
#  {'address': '觀塘九龍灣偉業街223-231號宏利金融中心B座8樓808室',
#   'coordinates': [22.307388, 114.224035],
#   'district': '觀塘區'},
#  {'address': '長沙灣山頂道481號（6期）香港紗廠工業大廈3樓J室',
#   'coordinates': [22.3388841, 114.1505773],
#   'district': '深水埗區'},
#  {'address': '葵涌貨櫃碼頭路88號永德利廣場1座26樓2606-10室',
#   'coordinates': [22.3524819, 114.1243341],
#   'district': '葵青區'},
#  {'address': '觀塘開源道49號創貿廣場12樓2201室',
#   'coordinates': [22.310293, 114.223668],
#   'district': '觀塘區'},
#  {'address': '葵涌和宜合道63號麗晶中心A座17樓17-18室',
#   'coordinates': [22.3672642, 114.1378971],
#   'district': '葵青區'},
#  {'address': '長沙灣長裕街8號億京廣場21樓2108室',
#   'coordinates': [22.336585, 114.150659],
#   'district': '深水埗區'},
#  {'address': '觀塘創業街25號創富中心19樓1901-1903室',
#   'coordinates': [22.313953, 114.219674],
#   'district': '觀塘區'},
#  {'address': '荔枝角衛城道700號時運中心1004室',
#   'coordinates': [22.3377995, 114.1458397],
#   'district': '深水埗區'},
#  {'address': '葵涌貨櫃碼頭路51-63號葵順工業中心北翼3樓A2',
#   'coordinates': [22.3532957, 114.1241366],
#   'district': '葵青區'},
#  {'address': '葵涌葵喜街13-29號永恆工業大廈5樓503室',
#   'coordinates': [22.3568072, 114.1237302],
#   'district': '葵青區'},
#  {'address': '荃灣沙咀道52A號皇廷廣場2705-8室',
#   'coordinates': [22.373363, 114.109473],
#   'district': '荃灣區'}]

import googlemaps
import json
from route_clustering import RouteClustering as rc
import socket
# HOST = '172.17.10.215'
# PORT = 23456

# with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
#     s.bind((HOST, PORT))
#     s.listen()
#     conn, addr = s.accept()
#     with conn:
#         data = conn.recv(8192)  
"""
data should be a json obj in the following structure.
data =  [{
            'address': '葵涌葵喜街13-29號永恆工業大廈5樓503室',
            'coordinates': [22.3568072, 114.1237302],
            'district': '葵青區'
            },
        {
            'address': '荃灣沙咀道52A號皇廷廣場2705-8室',
            'coordinates': [22.373363, 114.109473],
            'district': '荃灣區'
            }]
"""

# # Google API enabling with KEY
# gm = googlemaps.Client(key='AIzaSyDOa6NIT66QT4zO239JqSR5azRvUaaa4vI')

data =  [{
            'address': '葵涌葵喜街13-29號永恆工業大廈5樓503室',
            'coordinates': [22.3568072, 114.1237302],
            'district': '葵青區'
            },
        {
            'address': '荃灣沙咀道52A號皇廷廣場2705-8室',
            'coordinates': [22.373363, 114.109473],
            'district': '荃灣區'
            },
        {'address': '觀塘海濱道177號海裕工業中心3字 樓',
		'coordinates': [22.3098695, 114.22021],
		'district': '觀塘區'},
		{'address': '香港荃灣德士古道220-248號全灣工業中心10樓1008室',
		'coordinates': [22.36504, 114.115642],
		'district': '荃灣區'},
		{'address': '新界葵涌貨櫃碼頭51-63號葵順工業中心2樓E室',
		'coordinates': [22.3532957, 114.1241366],
		'district': '葵青區'},
		{'address': '九龍深水步石硤尾街1號地下M3鋪',
		'coordinates': [22.3276924, 114.1632293],
		'district': '深水埗區'},
		{'address': '觀塘榮業街2號振萬廣場 4樓403-405室 ',
		'coordinates': [22.3073397, 114.2230667],
		'district': '葵青區'},
		{'address': '九龍灣常悅道9號企業廣場1期2座905室',
		'coordinates': [22.3220434, 114.207954],
		'district': '觀塘區'},]

ntkl_locations = []
hk_locations = []
coor_to_address = {}
hk = ['中西區', '灣仔區', '東區', '南區']

for loc in data:
    if loc['district'] in hk:
        hk_locations.append(loc['coordinates'])
    else:
        ntkl_locations.append(loc['coordinates'])

    coor_to_address[tuple(loc['coordinates'])] = loc['address']

cluster_result = rc.kmeans_cluster(ntkl_locations, hk_locations)



work_time = {}
work_route = {}
for loc in cluster_result:
    work_info = rc.get_work_info(cluster_result[loc]['points'], coor_to_address)
    work_time[loc] = work_info['duration']
    work_route[loc] = work_info['route']
   
dic_99 = {}
while rc.is_balanced(work_time):
    # This if condition is used to make sure points from HK route is never shared to other routes.
    if max(work_time, key=work_time.get) == 99:
        dic_99[99] = {'points': cluster_result[99]['points']}
        cluster_result.pop(99)  
        work_time.pop(99)
        work_route.pop(99)
    
    cluster_result = rc.rearrange_routes(work_time, cluster_result)
 
    for loc in cluster_result:
        work_info = rc.get_work_info(cluster_result[loc]['points'], coor_to_address)
        work_time[loc] = work_info['duration']
        work_route[loc] = work_info['route']
    
# Put the 99 (HK) route back to the result if HK route has been the longest
if dic_99:  
    work_route[99] = dic_99[99]

print(work_route)

# conn.sendall(work_route)    

